## Лабораторная работа №3 — Управление ресурсами и использование хуков

Мобильное приложение финансового трекера на **React Native (Expo)** с микросервисной архитектурой, демонстрирующее:
- **Управление ресурсами приложения** (API запросы, локальное хранилище, кэширование)
- **Использование хуков** для управления состоянием и жизненным циклом компонентов

### Функциональность

#### Микросервисная архитектура
Приложение разделено на независимые сервисы:
- **expensesService** — управление расходами
- **categoriesService** — управление категориями
- **leaderboardService** — лидерборд экономии
- **postsService** — посты блога
- **profileService** — профиль пользователя

#### Управление ресурсами
- **API интеграция** — работа с реальной базой данных Neon PostgreSQL
- **Локальное хранилище** — AsyncStorage для кэширования данных и токенов
- **Кэширование** — автоматическое кэширование с временными метками
- **Обработка ошибок** — централизованная обработка сетевых ошибок

#### Использование хуков
- **useState** — управление локальным состоянием компонентов
- **useEffect** — загрузка данных при монтировании компонентов
- **useMemo** — оптимизация вычислений
- **useCallback** — мемоизация функций
- **Кастомные хуки** — `useExpenses`, `useCategories`, `useLeaderboard`, `usePosts`, `useProfile`

### Структура проекта

```
lab3/
├── config/
│   └── api.js              # Конфигурация API и эндпоинтов
├── services/               # Микросервисы для каждого домена
│   ├── expensesService.js
│   ├── categoriesService.js
│   ├── leaderboardService.js
│   ├── postsService.js
│   └── profileService.js
├── hooks/                  # Кастомные хуки
│   ├── useExpenses.js
│   ├── useCategories.js
│   ├── useLeaderboard.js
│   ├── usePosts.js
│   └── useProfile.js
├── utils/                  # Утилиты
│   ├── apiClient.js        # HTTP клиент для API
│   └── storage.js          # Работа с AsyncStorage
├── App.js                  # Главный компонент приложения
└── package.json
```

### Технологии

- [Expo](https://expo.dev/) (React Native)
- [AsyncStorage](https://react-native-async-storage.github.io/async-storage/) — локальное хранилище
- Neon PostgreSQL — база данных
- Микросервисная архитектура

### Установка и запуск

1. **Клонировать репозиторий:**
```bash
git clone <repository-url>
cd lab3
```

2. **Установить зависимости:**
```bash
npm install
```

3. **Запустить Next.js сервер (из папки kursachweb2025-main):**
```bash
cd ../kursachweb2025-main
npm install  # если еще не установлены зависимости
npm run dev  # запускает сервер на http://localhost:3000
```

4. **Настроить API URL (если нужно):**
Отредактируй `config/api.js` и укажи IP адрес твоего компьютера (для работы на реальном устройстве):
```javascript
export const API_BASE_URL = 'http://192.168.0.20:3000'; // IP адрес уже настроен автоматически
```
**Важно:** На Android/iOS устройствах `localhost` не работает, нужен IP адрес компьютера в локальной сети.

5. **Запустить мобильное приложение:**
```bash
cd ../lab3
npm start
```

Далее можно:
- открыть через Expo Go (Android/iOS);
- запустить эмулятор: `npm run android`;
- запустить веб-версию: `npm run web`.

### Настройка базы данных

Приложение подключается к Neon PostgreSQL. Строка подключения:
```
postgresql://neondb_owner:npg_W8KC1GJjmRIy@ep-blue-cake-abtejvo4-pooler.eu-west-2.aws.neon.tech/neondb?sslmode=require&channel_binding=require
```

Схема БД описана в `kursachweb2025-main/prisma/schema.prisma`.

### Основные концепции

#### 1. Микросервисная архитектура
Каждый домен (расходы, категории, лидерборд и т.д.) имеет свой независимый сервис, что упрощает разработку и поддержку.

#### 2. Управление ресурсами
- **API запросы** — централизованный HTTP клиент (`utils/apiClient.js`)
- **Локальное хранилище** — кэширование данных в AsyncStorage
- **Инвалидация кэша** — автоматическая очистка кэша при изменении данных

#### 3. Хуки для управления состоянием
- **useState** — хранение состояния компонентов
- **useEffect** — выполнение побочных эффектов (загрузка данных)
- **useMemo** — мемоизация вычислений
- **useCallback** — мемоизация функций

### Документация

Подробное описание реализации с листингом кода и комментариями см. в `REPORT.md`.

### Как получить PDF-отчёт

```bash
pandoc REPORT.md -o REPORT.pdf
```
